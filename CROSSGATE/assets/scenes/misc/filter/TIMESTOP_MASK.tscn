[gd_scene load_steps=4 format=2]

[ext_resource path="res://assets/sprites/misc/ShaderFX/glitch.jpg" type="Texture" id=1]

[sub_resource type="Shader" id=1]
code = "shader_type canvas_item;
render_mode unshaded;

uniform bool grayscale = false;
uniform sampler2D displace : hint_albedo;
uniform float displaceAmount : hint_range(0, 0.1);
uniform float abberationAmount : hint_range(0, 0.1);
uniform float displaceSize : hint_range(0, 1);
uniform float displaceFrequency : hint_range(0, 10);

void fragment() {
	vec4 disp = texture(displace, SCREEN_UV * abs(sin(TIME * displaceFrequency))*displaceSize);
	vec2 newUV = SCREEN_UV + disp.xy * abs(sin(TIME))*displaceAmount;
	COLOR.r = 1.0 - texture(SCREEN_TEXTURE, newUV - cos(TIME)*abberationAmount).r;
	COLOR.g = 1.0 - texture(SCREEN_TEXTURE, newUV).g;
	COLOR.b = 1.0 - texture(SCREEN_TEXTURE, newUV - sin(TIME)*abberationAmount).b;
	COLOR.a = texture(SCREEN_TEXTURE, newUV).a;
	if(grayscale){
		COLOR.rgb = vec3(dot(COLOR.rgb, vec3(0.299, 0.587, 0.114)));
	}
}"

[sub_resource type="ShaderMaterial" id=2]
shader = SubResource( 1 )
shader_param/grayscale = false
shader_param/displaceAmount = 0.008
shader_param/abberationAmount = 0.012
shader_param/displaceSize = 1.0
shader_param/displaceFrequency = 10.0
shader_param/displace = ExtResource( 1 )

[node name="TIMESTOP_MASK" type="ColorRect"]
modulate = Color( 1, 1, 1, 0 )
material = SubResource( 2 )
margin_left = -344.167
margin_top = -295.0
margin_right = 1454.83
margin_bottom = 888.0
